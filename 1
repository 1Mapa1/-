#include <stdlib.h>
#include <iostream>
#include <string>
bool CheckWin(std::string arr[3][3])
{
    for (int i = 0; i < 3; i++)
    {
        if (arr[i][0] == arr[i][1] && arr[i][1] == arr[i][2])
        {
            return true;
        }
        else if (arr[0][i] == arr[1][i] && arr[1][i] == arr[2][i])
        {
            return true;
        }
        else if (arr[0][0] == arr[1][1] && arr[2][2] == arr[1][1] || arr[0][2] == arr[1][1] && arr[2][0] == arr[1][1])
        {
            return true;
        }
        return false;
    }
}
int main()
{
    std::string arrGame[3][3]{ {"1","2","3"},{"4","5","6"},{"7","8","9"}};
    int count = 1;
    int menu;
    bool game = true;
    int settings;
    int playmenu;
    int change;
    std::string nameplayer1 = "Игрок 1";
    std::string nameplayer2 = "Игрок 2";
    std::string info[9];
    bool offGame = 1;
    bool offMenu = 1;
    std::string symbPlayer1 = "X";
    std::string symbPlayer2 = "O";
    int colorCount = 0;
    std::string colorPlayer1 = "\x1b[34mСиний\x1b[34m";
    std::string colorPlayer2 = "\x1b[34mСиний\x1b[34m";
    std::string arrColor[2][3]{ {"\x1b[34m","\x1b[31m","\x1b[32m"},{"Синий","Красный","Зеленый"} };
    setlocale(0, "");
    while (true) {
        offMenu = 1;
        system("cls");
        std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Игра <<Крестики нолики>>\x1b[0m\n\n";

        std::cout << "\x1b[91m1\x1b[0m \x1b[97m| Начать игру\n";
        std::cout << "\x1b[91m2\x1b[0m \x1b[97m| Статистика\n";
        std::cout << "\x1b[91m3\x1b[0m \x1b[97m| Настройка\n";
        std::cout << "\x1b[91m4\x1b[0m \x1b[97m| Выйти\n\n";

        std::cout << "\x1b[91m>\x1b[0m \x1b[97m| Введите число: \x1b[90m"; std::cin >> menu;
        while (offMenu) {
            switch (menu)
            {
            
            case 1:
                system("cls");
                std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Игра <<Крестики нолики>>\x1b[0m\n\n";
                std::cout << "\x1b[91m1\x1b[0m \x1b[97m| Одиночная игра\n";
                std::cout << "\x1b[91m2\x1b[0m \x1b[97m| Два игрока\n\n";
                std::cout << "\x1b[91m3\x1b[0m \x1b[97m| Назад\n";
                std::cout << "\x1b[91m>\x1b[0m \x1b[97m| Ввод: \x1b[90m"; std::cin >> playmenu;
                if (playmenu == 3) {
                    offMenu = 0;
                }
                switch (playmenu)
                {
                case 1:
                    while (game)
                    {
                        system("cls");
                        std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Крестики нолики\n";
                        for (int i = 0;i < 3; i++) {
                            for (int j = 0;j < 3; j++) {
                                std::cout << arrGame[i][j];
                                if (j <= 1) {
                                    std::cout << " | ";
                                }
                            }
                            if (i != 2)
                            {
                                std::cout << "\n__________" << std::endl;
                            }
                        }
                        int answer;
                        if (count % 2 == 1)
                        {
                            std::cout << "\n\x1b[91m>\x1b[0m | Ходит " << nameplayer1 << " : ";
                            std::cin >> answer;
                            answer--;
                            arrGame[answer / 3][answer % 3] = symbPlayer1;
                            count++;
                        }
                        else
                        {
                            std::cout << "\n\x1b[91m>\x1b[0m | Ходит " << nameplayer2 << " : ";
                            std::cin >> answer;
                            answer--;
                            arrGame[answer / 3][answer % 3] = symbPlayer2;
                            count++;
                        }
                        if (CheckWin(arrGame))
                        {
                            if (count % 2 == 0)
                            {
                                std::cout << "Победил " << nameplayer1;
                            }
                            else
                            {
                                std::cout << "Победил " << nameplayer2;
                            }
                            break;
                        }
                    }
                    break;
                case 2:
                    break;

                }


                break;
            case 2:
                break;
            case 3:
                system("cls");
                offGame = true;
                std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Настройка игрока\n\n";

                std::cout << "\x1b[91m1\x1b[0m \x1b[97m| Игрок 1\n";
                std::cout << "\x1b[91m2\x1b[0m \x1b[97m| Игрок 2\n\n";
                std::cout << "\x1b[91m3\x1b[0m \x1b[97m| Назад\n";

                std::cout << "\x1b[91m>\x1b[0m \x1b[97m| Ввод: \x1b[90m"; std::cin >> settings;
                if (settings == 3) {
                    offMenu = 0;
                }
                while (true) {
                    switch (settings)
                    {
                    
                    case 1:
                        while (offGame == true) {
                            system("cls");
                            std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Настройка игрока\n\n";

                            std::cout << "\x1b[91m1\x1b[0m \x1b[97m| Ник    : " << nameplayer1 << std::endl;
                            std::cout << "\x1b[91m2\x1b[0m \x1b[97m| Фигура : " << symbPlayer1 << std::endl;
                            std::cout << "\x1b[91m3\x1b[0m \x1b[97m| Цвет   : " << colorPlayer1 << std::endl << std::endl;
                            std::cout << "\x1b[91m4\x1b[0m \x1b[97m| Назад  " << std::endl;

                            std::cout << "\x1b[91m>\x1b[0m \x1b[97m| Ввод: \x1b[90m"; std::cin >> change;
                            switch (change)
                            {
                            
                            case 1:
                                std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Введите новое имя игрока: "; std::cin >> nameplayer1;

                                break;
                            case 2:
                                std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Введите новую фигуру игрока: "; std::cin >> symbPlayer1;
                                break;
                            case 3:
                                std::cout << arrColor[0][0] + arrColor[1][0];
                                colorPlayer1 = arrColor[0][colorCount] + arrColor[1][colorCount];

                                colorCount++;
                                if (colorCount == 3) {
                                    colorCount = 0;
                                }
                                break;

                            }
                            if (change == 4) { offGame = false; }
                        }
                        break;


                    case 2:
                        while (offGame == true) {
                            system("cls");
                            std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Настройка игрока\n\n";

                            std::cout << "\x1b[91m1\x1b[0m \x1b[97m| Ник    : " << nameplayer2 << std::endl;
                            std::cout << "\x1b[91m2\x1b[0m \x1b[97m| Фигура : " << symbPlayer2 << std::endl;
                            std::cout << "\x1b[91m3\x1b[0m \x1b[97m| Цвет   : " << colorPlayer2 << std::endl << std::endl;
                            std::cout << "\x1b[91m4\x1b[0m \x1b[97m| Назад  " << std::endl;

                            std::cout << "\x1b[91m>\x1b[0m \x1b[97m| Ввод: \x1b[90m"; std::cin >> change;
                            switch (change)
                            {
                            default:
                                break;
                            case 1:
                                std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Введите новое имя игрока: "; std::cin >> nameplayer2;

                                break;
                            case 2:
                                std::cout << "\x1b[91m+\x1b[0m \x1b[97m| Введите новую фигуру игрока: "; std::cin >> symbPlayer2;
                                break;
                            case 3:
                                std::cout << arrColor[0][0] + arrColor[1][0];
                                colorPlayer2 = arrColor[0][colorCount] + arrColor[1][colorCount];

                                colorCount++;
                                if (colorCount == 3) {
                                    colorCount = 0;
                                }
                                break;

                            }
                            if (change == 4) { offGame = false; }
                        }
                        break;
                    }
                    ;
                    break;
                }

            case 4:


                break;
            }
        }
    }




}
